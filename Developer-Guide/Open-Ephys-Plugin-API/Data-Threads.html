
<!DOCTYPE html>


<html lang="en" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data Threads &#8212; Open Ephys GUI Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Record Engines" href="Record-Engines.html" />
    <link rel="prev" title="Visualizer Plugins" href="Visualizer-Plugins.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
    
    <img src="../../_static/oe_logo_name.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/oe_logo_name.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../User-Manual/index.html">
                        User Manual
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../FAQ/index.html">
                        FAQs
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/open-ephys/gui-docs" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/openephys" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/WXAx2URNQU" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../User-Manual/index.html">
                        User Manual
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Developer Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../Tutorials/index.html">
                        Tutorials
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../FAQ/index.html">
                        FAQs
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/open-ephys/gui-docs" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/openephys" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-twitter"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/WXAx2URNQU" title="Discord" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discord"></i></span>
            <label class="sr-only">Discord</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Compiling-the-GUI.html">Compiling the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Compiling-plugins.html">Compiling plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Creating-a-new-plugin.html">Creating a new plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Common-and-external-libraries.html">Common and external libraries</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Open Ephys Plugin API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Processor-Plugins.html">Processor Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="Visualizer-Plugins.html">Visualizer Plugins</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data Threads</a></li>
<li class="toctree-l2"><a class="reference internal" href="Record-Engines.html">Record Engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="File-Sources.html">File Sources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Distributing-plugins.html">Distributing plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Modifying-the-host-application.html">Modifying the host application</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Developer Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Open Ephys Plugin API</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Data Threads</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="data-threads">
<span id="datathreads"></span><h1>Data Threads<a class="headerlink" href="#data-threads" title="Permalink to this heading">#</a></h1>
<table class="table" id="id1">
<caption><span class="caption-text">Data Threads bring data into the signal chain from external hardware.</span><a class="headerlink" href="#id1" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><em>Type</em></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">Plugin::Type::DATA_THREAD</span></code></p></td>
</tr>
<tr class="row-even"><td><p><em>Base Classes</em></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">DataThread</span></code>, <code class="code docutils literal notranslate"><span class="pre">DataBuffer</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><em>Template</em></p></td>
<td><p><a class="github reference external" href="https://github.com/open-ephys-plugins/data-thread-template">open-ephys-plugins/data-thread-template</a></p></td>
</tr>
</tbody>
</table>
<p><strong>Data Threads</strong> are special types of <a class="reference internal" href="Processor-Plugins.html#processorplugins"><span class="std std-ref">Processor Plugins</span></a> that communicate with a data acquisition device whose clock is not synchronized with the GUI’s internal processing callbacks. Instead of implementing a <code class="code docutils literal notranslate"><span class="pre">process()</span></code> method as a “Source” processor would, a Data Thread must implement an <code class="code docutils literal notranslate"><span class="pre">updateBuffer()</span></code> method that is called inside a separate thread. Any available data in this buffer will be automatically copied into the GUI’s signal chain for further processing.</p>
<p>Each Data Thread can generate an arbitrary number of data streams, each with an independent sample clock. The only limitations are that each data stream can only have one event “channel” (with up to 64 TTL lines), and the incoming data cannot contain spike events. Provided that the incoming data fits within these limitations, then it is strongly recommended to derive your plugin from a Data Thread, rather than building a custom Source Processor.</p>
<p>To create a new Data Thread, start with the <a class="reference external" href="https://github.com/open-ephys-plugins/data-thread-template">Data Thread Template</a> and add code that implements the following method:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412updateBufferv">
<span id="_CPPv312updateBufferv"></span><span id="_CPPv212updateBufferv"></span><span id="updateBuffer"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">updateBuffer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412updateBufferv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Adds any available data to a buffer (using <code class="code docutils literal notranslate"><span class="pre">DataBuffer::addToBuffer()</span></code>. Any data in this buffer will be automatically copied into the GUI’s signal chain during the next <code class="code docutils literal notranslate"><span class="pre">process()</span></code> callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns bool<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">true</span></code> if communication with the data acquisition device is intact. If the connection to the device is lost, return <code class="code docutils literal notranslate"><span class="pre">false</span></code> to terminate acquisition.</p>
</dd>
</dl>
</dd></dl>

<p>The following is an example of a minimal implementation of <code class="code docutils literal notranslate"><span class="pre">DataThread::updateBuffer()</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">raw_samples</span><span class="p">[</span><span class="n">MAX_SAMPLES_PER_BUFFER</span><span class="p">];</span>
<span class="kt">float</span><span class="w"> </span><span class="n">scaled_samples</span><span class="p">[</span><span class="n">MAX_SAMPLES_PER_BUFFER</span><span class="p">];</span>
<span class="n">int64</span><span class="w"> </span><span class="n">sample_numbers</span><span class="p">[</span><span class="n">MAX_SAMPLES_PER_BUFFER</span><span class="p">];</span>
<span class="n">uint64</span><span class="w"> </span><span class="n">event_codes</span><span class="p">[</span><span class="n">MAX_SAMPLES_PER_BUFFER</span><span class="p">];</span>
<span class="kt">double</span><span class="w"> </span><span class="n">timestamps</span><span class="p">[</span><span class="n">MAX_SAMPLES_PER_BUFFER</span><span class="p">];</span>
<span class="n">int64</span><span class="w"> </span><span class="n">totalSamples</span><span class="p">;</span>
<span class="n">AcquisitionDevice</span><span class="o">*</span><span class="w"> </span><span class="n">device</span><span class="p">;</span>
<span class="n">DataBuffer</span><span class="o">*</span><span class="w"> </span><span class="n">dataBuffer</span><span class="p">;</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">CustomDataThread::updateBuffer</span><span class="p">()</span>
<span class="p">{</span>

<span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">numRead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device</span><span class="o">-&gt;</span><span class="n">readData</span><span class="p">(</span><span class="n">raw_samples</span><span class="p">,</span><span class="w"> </span><span class="n">event_codes</span><span class="p">,</span><span class="w"> </span><span class="n">MAX_SAMPLES_PER_BUFFER</span><span class="p">);</span>

<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numRead</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="n">scaled_samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">raw_samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">scale_factor</span><span class="p">;</span>
<span class="w">      </span><span class="n">sample_numbers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalSamples</span><span class="o">++</span><span class="p">;</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="n">dataBuffer</span><span class="o">-&gt;</span><span class="n">addToBuffer</span><span class="p">(</span><span class="n">scaled_samples</span><span class="p">,</span>
<span class="w">                           </span><span class="n">sample_numbers</span><span class="p">,</span>
<span class="w">                           </span><span class="n">timestamps</span><span class="p">,</span>
<span class="w">                           </span><span class="n">event_codes</span><span class="p">,</span>
<span class="w">                           </span><span class="n">numRead</span><span class="p">);</span>

<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
<p>In order to inform downstream plugins about the channels generated by a Data Thread, the following method must be implemented:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414updateSettingsP10OwnedArrayI17ContinuousChannelEP10OwnedArrayI12EventChannelEP10OwnedArrayI12SpikeChannelEP10OwnedArrayI10DataStreamEP10OwnedArrayI10DeviceInfoEP10OwnedArrayI19ConfigurationObjectE">
<span id="_CPPv314updateSettingsP10OwnedArrayI17ContinuousChannelEP10OwnedArrayI12EventChannelEP10OwnedArrayI12SpikeChannelEP10OwnedArrayI10DataStreamEP10OwnedArrayI10DeviceInfoEP10OwnedArrayI19ConfigurationObjectE"></span><span id="_CPPv214updateSettingsP10OwnedArrayI17ContinuousChannelEP10OwnedArrayI12EventChannelEP10OwnedArrayI12SpikeChannelEP10OwnedArrayI10DataStreamEP10OwnedArrayI10DeviceInfoEP10OwnedArrayI19ConfigurationObjectE"></span><span id="updateSettings__OwnedArray:ContinuousChannel:P.OwnedArray:EventChannel:P.OwnedArray:SpikeChannel:P.OwnedArray:DataStream:P.OwnedArray:DeviceInfo:P.OwnedArray:ConfigurationObject:P"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">updateSettings</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">OwnedArray</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">ContinuousChannel</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">continuousChannels</span></span>, <span class="n"><span class="pre">OwnedArray</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">EventChannel</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">eventChannels</span></span>, <span class="n"><span class="pre">OwnedArray</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">SpikeChannel</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">spikeChannels</span></span>, <span class="n"><span class="pre">OwnedArray</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">DataStream</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sourceStreams</span></span>, <span class="n"><span class="pre">OwnedArray</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">DeviceInfo</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">devices</span></span>, <span class="n"><span class="pre">OwnedArray</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">ConfigurationObject</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">configurationObjects</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414updateSettingsP10OwnedArrayI17ContinuousChannelEP10OwnedArrayI12EventChannelEP10OwnedArrayI12SpikeChannelEP10OwnedArrayI10DataStreamEP10OwnedArrayI10DeviceInfoEP10OwnedArrayI19ConfigurationObjectE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Passes pointers to the Source processor’s info objects to the Data Thread, to allow them to be configured as needed. Note that only channels that have been added to a <code class="code docutils literal notranslate"><span class="pre">DataStream</span></code> object will be registered by downstream processors. And each <code class="code docutils literal notranslate"><span class="pre">DataStream</span></code> can only have one <code class="code docutils literal notranslate"><span class="pre">EventChannel</span></code> associated with it.</p>
</dd></dl>

<p>The following is an example of a minimal implementation of <code class="code docutils literal notranslate"><span class="pre">DataThread::updateSettings()</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="nf">CustomDataThread::updateSettings</span><span class="p">(</span><span class="n">OwnedArray</span><span class="o">&lt;</span><span class="n">ContinuousChannel</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">continuousChannels</span><span class="p">,</span>
<span class="w">     </span><span class="n">OwnedArray</span><span class="o">&lt;</span><span class="n">EventChannel</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">eventChannels</span><span class="p">,</span>
<span class="w">     </span><span class="n">OwnedArray</span><span class="o">&lt;</span><span class="n">SpikeChannel</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">spikeChannels</span><span class="p">,</span>
<span class="w">     </span><span class="n">OwnedArray</span><span class="o">&lt;</span><span class="n">DataStream</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">sourceStreams</span><span class="p">,</span>
<span class="w">     </span><span class="n">OwnedArray</span><span class="o">&lt;</span><span class="n">DeviceInfo</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">devices</span><span class="p">,</span>
<span class="w">     </span><span class="n">OwnedArray</span><span class="o">&lt;</span><span class="n">ConfigurationObject</span><span class="o">&gt;*</span><span class="w"> </span><span class="n">configurationObjects</span><span class="p">)</span>
<span class="p">{</span>

<span class="w">   </span><span class="n">sourceStreams</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">   </span><span class="n">continuousChannels</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">   </span><span class="n">eventChannels</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>

<span class="w">   </span><span class="n">DataStream</span><span class="o">::</span><span class="n">Settings</span><span class="w"> </span><span class="n">settings</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="s">&quot;device_stream&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// stream name</span>
<span class="w">      </span><span class="s">&quot;description&quot;</span><span class="p">,</span><span class="w">   </span><span class="c1">// stream description</span>
<span class="w">      </span><span class="s">&quot;identifier&quot;</span><span class="p">,</span><span class="w">    </span><span class="c1">// stream identifier</span>
<span class="w">      </span><span class="mf">30000.0</span><span class="w">          </span><span class="c1">// stream sample rate</span>
<span class="w">   </span><span class="p">};</span>

<span class="w">   </span><span class="n">DataStream</span><span class="o">*</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DataStream</span><span class="p">(</span><span class="n">settings</span><span class="p">);</span>

<span class="w">   </span><span class="n">sourceStreams</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span><span class="w"> </span><span class="c1">// add pointer to owned array</span>

<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">numChannels</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">      </span><span class="n">ContinuousChannel</span><span class="o">::</span><span class="n">Settings</span><span class="w"> </span><span class="n">settings</span><span class="p">{</span>
<span class="w">                             </span><span class="n">ContinuousChannel</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">ELECTRODE</span><span class="p">,</span><span class="w"> </span><span class="c1">// channel type</span>
<span class="w">                             </span><span class="s">&quot;CH&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="c1">// channel name</span>
<span class="w">                             </span><span class="s">&quot;description&quot;</span><span class="p">,</span><span class="w">      </span><span class="c1">// channel description</span>
<span class="w">                             </span><span class="s">&quot;identifier&quot;</span><span class="p">,</span><span class="w">       </span><span class="c1">// channel identifier</span>
<span class="w">                             </span><span class="mf">0.195</span><span class="p">,</span><span class="w">              </span><span class="c1">// channel bitvolts scaling</span>
<span class="w">                             </span><span class="n">stream</span><span class="w">              </span><span class="c1">// associated data stream</span>
<span class="w">                     </span><span class="p">};</span>

<span class="w">      </span><span class="n">continuousChannels</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ContinuousChannel</span><span class="p">(</span><span class="n">settings</span><span class="p">));</span>
<span class="w">   </span><span class="p">}</span>

<span class="w">   </span><span class="n">EventChannel</span><span class="o">::</span><span class="n">Settings</span><span class="w"> </span><span class="n">settings</span><span class="p">{</span>
<span class="w">                     </span><span class="n">EventChannel</span><span class="o">::</span><span class="n">Type</span><span class="o">::</span><span class="n">TTL</span><span class="p">,</span><span class="w"> </span><span class="c1">// channel type (must be TTL)</span>
<span class="w">                     </span><span class="s">&quot;Device Event Channel&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1">// channel name</span>
<span class="w">                     </span><span class="s">&quot;description&quot;</span><span class="p">,</span><span class="w">           </span><span class="c1">// channel description</span>
<span class="w">                     </span><span class="s">&quot;identifier&quot;</span><span class="p">,</span><span class="w">            </span><span class="c1">// channel identifier</span>
<span class="w">                     </span><span class="n">stream</span><span class="p">,</span><span class="w">                  </span><span class="c1">// associated data stream</span>
<span class="w">                     </span><span class="mi">8</span><span class="w">                        </span><span class="c1">// maximum number of TTL lines</span>
<span class="w">             </span><span class="p">};</span>

<span class="w">   </span><span class="n">eventChannels</span><span class="o">-&gt;</span><span class="n">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">EventChannel</span><span class="p">(</span><span class="n">settings</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A Data Thread must also implement the following three methods in order to be complete:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416foundInputSourcev">
<span id="_CPPv316foundInputSourcev"></span><span id="_CPPv216foundInputSourcev"></span><span id="foundInputSource"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">foundInputSource</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416foundInputSourcev" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Called after the plugin has initialized, to determine whether a connection to the data acquisition device has been established.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns bool<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">true</span></code> if the data source is connected, <code class="code docutils literal notranslate"><span class="pre">false</span></code> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416startAcquisitionv">
<span id="_CPPv316startAcquisitionv"></span><span id="_CPPv216startAcquisitionv"></span><span id="startAcquisition"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">startAcquisition</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416startAcquisitionv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Called just before acquisition begins, to signal that Data Thread should start streaming data from its device.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns bool<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">false</span></code> if there is an error in starting data transfer, which will cancel the request to start data acquisition.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415stopAcquisitionv">
<span id="_CPPv315stopAcquisitionv"></span><span id="_CPPv215stopAcquisitionv"></span><span id="stopAcquisition"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stopAcquisition</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415stopAcquisitionv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Called just before acquisition ends, to signal that Data Thread should stop streaming data from its device.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns bool<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="code docutils literal notranslate"><span class="pre">false</span></code> if there is an error in stopping data transfer (this return value is not currently handled).</p>
</dd>
</dl>
</dd></dl>

<p>In addition, the following virtual methods can be overriden to extend the functionality of a Data Thread:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412createEditorP10SourceNode">
<span id="_CPPv312createEditorP10SourceNode"></span><span id="_CPPv212createEditorP10SourceNode"></span><span id="createEditor__SourceNodeP"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">GenericEditor</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">createEditor</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">SourceNode</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sourceNode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412createEditorP10SourceNode" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Creates a custom editor for a Data Thread. If this method is not implemented, then a default editor will be created. See the <a class="reference internal" href="Processor-Plugins.html#processorplugins"><span class="std std-ref">Processor Plugins</span></a> documentation page for more information about editors. Note that the GUI’s built-in <code class="code docutils literal notranslate"><span class="pre">Parameter</span></code> class does not currently work with Data Threads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sourceNode</strong> – A pointer to the <code class="code docutils literal notranslate"><span class="pre">SourceNode</span></code> object (derived from the <code class="code docutils literal notranslate"><span class="pre">GenericProcessor</span></code> class) associated with this Data Thread.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422handleBroadcastMessage6String">
<span id="_CPPv322handleBroadcastMessage6String"></span><span id="_CPPv222handleBroadcastMessage6String"></span><span id="handleBroadcastMessage__String"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">handleBroadcastMessage</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">String</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">msg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422handleBroadcastMessage6String" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Allows the Data Thread plugin to respond to messages sent by other processors during acquisition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – The message that was sent. There are no restrictions on how this string will be formatted; each plugin is responsible for parsing this message in the appropriate way.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419handleConfigMessage6String">
<span id="_CPPv319handleConfigMessage6String"></span><span id="_CPPv219handleConfigMessage6String"></span><span id="handleConfigMessage__String"></span><span class="n"><span class="pre">String</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">handleConfigMessage</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">String</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">msg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419handleConfigMessage6String" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Allows the Data Thread plugin to handle a configuration message (usually sent via the OpenEphysHTTPServer) while acquisition is not active.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – The message that was sent. There are no restrictions on how this string will be formatted; each plugin is responsible for parsing this message in the appropriate way.</p>
</dd>
<dt class="field-even">Returns String<span class="colon">:</span></dt>
<dd class="field-even"><p>The response to the sender (e.g., an acknowledgement that the configuration message was handled properly)</p>
</dd>
</dl>
</dd></dl>

<p>The following method can be called by a Data Thread to send a message to all other processors in the signal chain while acquisition is active:</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416broadcastMessage6String">
<span id="_CPPv316broadcastMessage6String"></span><span id="_CPPv216broadcastMessage6String"></span><span id="broadcastMessage__String"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">broadcastMessage</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">String</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">msg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416broadcastMessage6String" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Allows the Data Thread to broadcast a custom string to all other processors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – The message that was sent. There are no restrictions on how this string will be formatted; each plugin is responsible for parsing this message in the appropriate way.</p>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Visualizer-Plugins.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Visualizer Plugins</p>
      </div>
    </a>
    <a class="right-next"
       href="Record-Engines.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Record Engines</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  
  <div class="tocsection editthispage">
    <a href="https://github.com/open-ephys/gui-docs/edit/main/source/Developer-Guide/Open-Ephys-Plugin-API/Data-Threads.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/Developer-Guide/Open-Ephys-Plugin-API/Data-Threads.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2010-2023, Open Ephys &amp; Contributors.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>