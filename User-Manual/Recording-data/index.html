
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recording data &#8212; Open Ephys Documentation 0.0.0 documentation</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/_static/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Binary format" href="Binary-format.html" />
    <link rel="prev" title="Building a signal chain" href="../Building-a-signal-chain.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../../index.html">
    
      <img src="../../_static/oe_logo_circle.svg" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item active">
            <a class="nav-link" href="../index.html">User Manual</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../Developer-Guide/index.html">Developer Guide</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../Tutorials/index.html">Tutorials</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../FAQ/index.html">FAQ</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/open-ephys" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/openephys" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
          
            
                <li class="">
                    <a href="../Before-you-begin.html">Before you begin</a>
                </li>
            
          
            
                <li class="">
                    <a href="../Installing-the-GUI.html">Installing the GUI</a>
                </li>
            
          
            
                <li class="">
                    <a href="../Exploring-the-user-interface.html">Exploring the user interface</a>
                </li>
            
          
            
                <li class="">
                    <a href="../Building-a-signal-chain.html">Building a signal chain</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="">Recording data</a>
                    <ul>
                    
                        <li class="">
                            <a href="Binary-format.html">Binary format</a>
                        </li>
                    
                        <li class="">
                            <a href="Open-Ephys-format.html">Open Ephys format</a>
                        </li>
                    
                        <li class="">
                            <a href="NWB-format.html">NWB format</a>
                        </li>
                    
                        <li class="">
                            <a href="KWIK-format.html">KWIK format</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="../Plugins/index.html">Plugins</a>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#global-recording-options" class="nav-link">Global recording options</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#available-data-formats" class="nav-link">Available data formats</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#using-the-record-node" class="nav-link">Using the Record Node</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#general-configuration" class="nav-link">General Configuration</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#recording-continuous-channels" class="nav-link">Recording Continuous Channels</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#recording-events" class="nav-link">Recording Events</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#recording-spikes" class="nav-link">Recording Spikes</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#multiple-record-nodes" class="nav-link">Multiple Record Nodes</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#synchronizer" class="nav-link">Synchronizer</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="recording-data">
<span id="recordingdata"></span><h1>Recording data<a class="headerlink" href="#recording-data" title="Permalink to this headline">¶</a></h1>
<p>The GUI provides a great deal of flexibility when it comes to recording data. It’s possible to write data from any point in the signal chain, using separate data directories or even different data formats. However, it’s important to be sure that your recording settings are configured properly, to ensure that you don’t lose valuable data.</p>
<p>As of version 0.5.0, the GUI won’t save data unless you have at least one Record Node in your signal chain. This is somewhat different from how things work previously, when every plugin had its own recording selection tab, and all data was streamed to a central data writing interface. This centralization created some unwanted inefficiencies and bottlenecks, which is why the Record Node now behaves like a separate plugin.</p>
<p>Just like any Filter processor, the Record Node can be placed after any Source, Filter, Splitter or Merger processor in your signal chain. However, Record Nodes do not modify the data passing through them, but instead copy and redirect the data to memory using a background thread. Individual Record Nodes inherit settings from the global recording options in the GUI’s control panel, but these settings can be overridden locally.</p>
<div class="section" id="global-recording-options">
<h2>Global recording options<a class="headerlink" href="#global-recording-options" title="Permalink to this headline">¶</a></h2>
<img alt="The global recording options interface" src="../../_images/global_record_options-01.png" />
<p>The GUI’s main control panel contains a collapsible panel with the global recording options. These include:</p>
<ul class="simple">
<li><p>The data format (see next section for more information)</p></li>
<li><p>An interface for configuring individual data formats (<strong>R</strong> button)</p></li>
<li><p>The default location for recording data (can be overridden by individual Record Nodes)</p></li>
<li><p>Text to prepend to the data directory name (default: blank)</p></li>
<li><p>The current date string used for naming the data directory (will display <code class="code docutils literal notranslate"><span class="pre">YYYY-MM-DD_HH-MM-SS</span></code> if recording hasn’t started yet)</p></li>
<li><p>Text to append to the data directory name (default: blank)</p></li>
<li><p>A button for starting a new data directory</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To prevent data from being overwritten, files are grouped by “experiments” and “recordings”. Whenever acquisition is stopped, the GUI begins a new experiment; whenever recording is stopped (without stopping acquisition), the GUI begins a new recording. Pressing the <strong>+</strong> button will reset both of these counters to 1.</p>
</div>
</div>
<div class="section" id="available-data-formats">
<h2>Available data formats<a class="headerlink" href="#available-data-formats" title="Permalink to this headline">¶</a></h2>
<p>The GUI currently supports the following data formats:</p>
<ul class="simple">
<li><p><a class="reference internal" href="Binary-format.html#binaryformat"><span class="std std-ref">Binary format</span></a> stores the data as an array of samples in the following order: ch1 sample1, ch2 sample 1, ch3 sample 1, …, chN sample 1, ch1 sample 2, ch2 sample 2, etc. It’s the most compact format, and therefore can be loaded very quickly. Extra data, like timestamps or events are stored in <a class="reference external" href="https://numpy.org/">NumPy</a> format, which can be easily read and converted to raw binary by stripping the header. Metadata about the recording, such as sample rates or channel counts are stored in an easy-to-parse JSON file.</p></li>
<li><p><a class="reference internal" href="Open-Ephys-format.html#openephysformat"><span class="std std-ref">Open Ephys format</span></a> stores data in files that contains both the data samples and markers that allow data to be recovered if any part of the file becomes corrupted. Each channel is stored in a separate file, which can be convenient or inconvenient for analysis, depending on what you need to do. It’s the first format that was used by the GUI, so it’s been the most extensively tested. However, it’s specific to Open Ephys, and will likely need to be converted to be compatible with most analysis tools. If you’re unsure about which format to use, or you’re running the GUI on a potentially unstable system, we’d recommend using this.</p></li>
<li><p><a class="reference internal" href="NWB-format.html#nwbdataformat"><span class="std std-ref">NWB format</span></a> stores data inside an HDF5 file, according to the specification defined by the <a class="reference external" href="https://www.nwb.org/">Neurodata Without Borders</a> project. It’s based on a one-file-per-experiment philosophy, and aims to ensure that the data is self-documenting and easy to share. It comes with all the baggage of HDF5, including the need for a large library to access the data, and the inability to read any of the data if the file becomes corrupted. The Open Ephys NWB format is currently based on the deprecated v1.0 specification, but an up-to-date 2.0 format is coming soon.</p></li>
<li><p><a class="reference internal" href="KWIK-format.html#kwikdataformat"><span class="std std-ref">KWIK format</span></a> designed for use with the <a class="reference external" href="https://github.com/klusta-team/klustakwik">KlustaKwik</a> spike sorting package, and is also based on HDF5. It has since been abandoned by the developers of KlustaKwik, for the <a class="reference external" href="https://cyrille.rossant.net/moving-away-hdf5/">reasons outlined here</a>. We’ll continue to support the KWIK format for Open Ephys data, but we’d recommend moving away from it if you can.</p></li>
</ul>
</div>
<div class="section" id="using-the-record-node">
<h2>Using the Record Node<a class="headerlink" href="#using-the-record-node" title="Permalink to this headline">¶</a></h2>
<p>The Record Node, found in the “Recording” section of the Processor List, controls how data is written to disk. Every signal chain requires at least one Record Node in order to save data.</p>
<p>Adding a Record Node into a signal chain brings up the following interface:</p>
<img alt="The Record Node interface" src="../../_images/recordnode-01.png" />
<div class="section" id="general-configuration">
<h3>General Configuration<a class="headerlink" href="#general-configuration" title="Permalink to this headline">¶</a></h3>
<p>On the top-right of the editor is the <strong>write path selector</strong> which opens up an explorer window to navigate to the desired write directory. Use this to set the root path of where the data files generated from this RecordNode will be stored.</p>
<p>Directly below, the <strong>engine selector</strong> pull-down lists the available recording formats. Both the write path selector and the engine selector default to the values shown in the Control Panel.</p>
<p>To the left of the engine selector is the <strong>disk space monitor</strong>, which indicates the amount of free space available at the path shown by the write path selector.</p>
</div>
<div class="section" id="recording-continuous-channels">
<h3>Recording Continuous Channels<a class="headerlink" href="#recording-continuous-channels" title="Permalink to this headline">¶</a></h3>
<p>The continuous channel configuration interfaces are hidden by default, so you will need to use the <strong>show/hide subprocessors</strong> toggle to access them. This displays a set of <strong>continuous channel buffer monitors</strong> and <strong>sync monitors</strong> for every subprocessor. Each subprocessor contains channels that are guaranteed to be sampled synchronously. If there are blocks of channels with different sample rates (for example, from different Neuropixels probes), they will each belong to a separate subprocessor.</p>
<p>The continuous channel buffer monitors track the state of the recording buffer for each subprocessor. If these start to fill up, it indicates that your computer can’t keep up with disk writing. In that case, you can try reducing the number of channels being recorded, or split the disk writing duties across multiple record nodes (see below).</p>
<p>Clicking on one of the continuous channel buffer monitors opens up a <strong>channel selector interface</strong> as shown below. By default, the interface has every channel set to record. Through the interface, you can toggle individual channels on/off, select ALL or NONE, or indicate a custom range of channels using Matlab-style slicing:</p>
<img alt="Selecting every other channel" src="../../_images/EVERY_OTHER.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Click and drag multi-channel selection is also available:</p>
<img alt="Selecting every other channel" src="../../_images/FREE_SELECT.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Click anywhere outside the channel selector or use the ESC key to exit.</p>
</div>
<div class="section" id="recording-events">
<h3>Recording Events<a class="headerlink" href="#recording-events" title="Permalink to this headline">¶</a></h3>
<p>Below the engine selector is the <strong>toggle event recording</strong> button, which determines whether this Record Node will save incoming events. This will be turned on by default, and should only be turned off if you’re sure events are being saved by another Record Node. Regardless of the toggle state, underlying events will not be modified by the Record Node.</p>
</div>
<div class="section" id="recording-spikes">
<h3>Recording Spikes<a class="headerlink" href="#recording-spikes" title="Permalink to this headline">¶</a></h3>
<p>The <strong>toggle spikes recording</strong> button will enable/disable recording of any spike data coming into this Record Node. In order for spikes to be detected by the Record Node, you must have a spike-generating processor somewhere upstream of the Record Node in your signal chain.</p>
</div>
<div class="section" id="multiple-record-nodes">
<h3>Multiple Record Nodes<a class="headerlink" href="#multiple-record-nodes" title="Permalink to this headline">¶</a></h3>
<p>A Record Node can be placed after any Source, Filter, Sink, Splitter, or Merger in your signal chain. In the example below, we are able to record the raw data coming from Neuropixels probes while simultaneously recording the same data after it has passed through a <a class="reference internal" href="../Plugins/Bandpass-Filter.html#bandpassfilter"><span class="std std-ref">Bandpass Filter</span></a>. In this case, we have configured the first Record Node to write the raw data in the Binary format, while the second Record Nodes will write the filtered data in NWB format.</p>
<img alt="Using multiple Record Nodes" src="../../_images/recordnode-02.png" />
</div>
<div class="section" id="synchronizer">
<h3>Synchronizer<a class="headerlink" href="#synchronizer" title="Permalink to this headline">¶</a></h3>
<p>The Record Node has a built-in synchronizer module which can perform real-time alignment of timestamps from asynchronous data sources. The synchronizer only works if each data stream has a TTL channel connected to the same physical digital input line. Each time a new event comes in (either a rising or falling edge), the synchronizer will update its estimate of the true sample rate of each subprocessor, based on the total number of samples that have been received since the first event. The Record Node will generate a <code class="code docutils literal notranslate"><span class="pre">sychronized_timestamps.npy</span></code> file containing the timestamps (in seconds) relative to the time of the first event.</p>
<p>Below each continuous channel buffer monitor is a <strong>sync channel monitor</strong> which provides an interface for designating an input subprocessor as the master clock, as well as selecting a digital input channel for each subprocessor to serve as a sync channel. Again, all of the TTL channels used for synchronization must be connected to the same physical digital input line in order for the synchronizer to work properly. There can only be one sync channel per data source and the active sync channel is always indicated with an orange background.</p>
<p>The active master subprocessor will be indicated by a letter ‘M’ on its sync channel monitor. This subprocessor will be used as the reference clock, to which all other subprocessors will be synchronized.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<img alt="View of the synchronizer interface" src="../../_images/SynchronizerInterface.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Once the synchronizer has been configured, starting data acquisition as normal will automatically start the synchronizer. Each sync channel monitor will change from gray to orange to indicate the synchronizer is running. Once a subprocessor has been synchronized with the master, the corresponding sync channel monitor will turn green. Data sources with higher sample rates will generally synchronize more quickly than those with lower sample rates.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<img alt="Another view of the synchronizer interface" src="../../_images/recordnode-03.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Currently, the synchronizer will only generate outputs when using the Binary data format for recording. The result is a <code class="code docutils literal notranslate"><span class="pre">synchronized_timestamps.npy</span></code> file that contains a double (<code class="code docutils literal notranslate"><span class="pre">float64</span></code>) timestamp for each <code class="code docutils literal notranslate"><span class="pre">int64</span></code> timestamp found in the original, unsynchronized timestamps.npy file for each data source.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The synchronizer is a quick-and-easy way to generate aligned timestamps with ~0.1 ms resolution (for 30 kHz inputs). However, it will never be as accurate as synchronization performed offline, especially for recordings longer than one hour. Offline synchronization is recommended for any analysis that requires fine temporal precision.</p>
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="../Building-a-signal-chain.html" title="previous page">Building a signal chain</a>
    <a class='right-next' id="next-link" href="Binary-format.html" title="next page">Binary format</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2010-2020, Open Ephys &amp; Contributors.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>